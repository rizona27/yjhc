# 业绩表现回测工具

一个用于分析投资产品业绩表现的桌面应用程序，支持数据导入、业绩分析、净值趋势可视化等功能。

## 功能特点

- **数据导入**：支持CSV、Excel格式文件导入，自动识别日期和单位净值列
- **业绩分析**：
  - 自动计算固定周期（近一周至近一年）的业绩表现
  - 支持自定义日期区间分析
  - 计算年化收益率和最大回撤等关键指标
- **净值可视化**：
  - 生成净值趋势图
  - 自动标记最高点和最低点
  - 支持图表导出功能
- **用户友好界面**：
  - 直观的操作布局
  - 详细的系统日志
  - 响应式设计

## 界面说明

程序界面主要分为以下几个区域：

1. **配置区**：包含数据导入、图表导出、应用重置和使用说明按钮，以及自定义日期区间选择器
2. **分析结果区**：
   - 固定周期回测结果（表格形式展示）
   - 自定义周期回测结果（关键指标展示）
3. **系统日志**：记录操作过程和系统信息
4. **净值趋势图**：可视化展示净值变化趋势

## 安装说明

### 前提条件

- Python 3.6 或更高版本

### 安装步骤

1. 克隆或下载本项目
2. 安装依赖包：

```bash
pip install pandas matplotlib openpyxl xlrd python-dateutil psutil
```

3. 运行程序：

```bash
python performance_backtest_tool.py
```

## 使用指南

### 基本操作流程

1. **导入数据**：
   - 点击"导入数据"按钮
   - 选择包含日期和单位净值数据的CSV或Excel文件
   - 程序会自动识别并加载数据

2. **查看分析结果**：
   - 数据导入后，系统会自动计算固定周期的业绩表现
   - 结果显示在"固定周期回测"表格中

3. **自定义分析**：
   - 在日期输入框中设置起始日期和结束日期
   - 点击"分析区间"按钮查看自定义区间的业绩表现
   - 点击"恢复全览"返回完整数据视图

4. **导出图表**：
   - 点击"导出图表"按钮
   - 选择保存路径和文件名
   - 图表将以PNG格式保存

## 数据格式要求

导入的数据文件应包含至少两列信息：
- 日期列：包含日期信息（支持多种日期格式）
- 单位净值列：包含产品的单位净值数据

程序会自动识别这些列，无需严格匹配特定列名。

## 依赖项

- tkinter：GUI界面
- pandas：数据处理
- matplotlib：图表绘制
- openpyxl/xlrd：Excel文件处理
- python-dateutil：日期解析
- psutil：进程管理

## 使用提示

- 日期格式支持多种形式（YYYY-MM-DD、YYYYMMDD等）
- 最多可同时打开2个应用窗口
- 系统日志支持右键复制功能
- 导入大型文件时请耐心等待，系统会在日志中显示处理进度